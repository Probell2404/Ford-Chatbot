const express = require('express');
const line = require('@line/bot-sdk');
const axios = require('axios');

// Load environment variables
require('dotenv').config();

// LINE Channel Configuration
const config = {
  channelAccessToken: process.env.CHANNEL_ACCESS_TOKEN,
  channelSecret: process.env.CHANNEL_SECRET
};

// р╕кр╕гр╣Йр╕▓р╕З LINE client
const client = new line.Client(config);

// р╕кр╕гр╣Йр╕▓р╕З Express app
const app = express();

// р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕гр╕Цр╕вр╕Щр╕Хр╣М Ford (р╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕Др╣Йр╕Щр╕лр╕▓)
const fordData = {
  ranger: {
    name: "Ford Ranger 2024-2025",
    models: ["XL", "XLT", "Sport", "Wildtrak", "Platinum", "Raptor"],
    engines: [
      {
        type: "2.3L Turbo 4-cylinder",
        power: "270 HP",
        description: "р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣Мр╣Ар╕Ър╕Щр╕Лр╕┤р╕Щр╣Ар╕Чр╕нр╕гр╣Мр╣Вр╕Ъ 4 р╕кр╕╣р╕Ъ р╕Вр╕Щр╕▓р╕Ф 2.3 р╕ер╕┤р╕Хр╕г"
      },
      {
        type: "2.7L Twin-Turbo V6",
        power: "315 HP", 
        description: "р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣Мр╣Ар╕Ър╕Щр╕Лр╕┤р╕Щр╕Чр╕зр╕┤р╕Щр╣Ар╕Чр╕нр╕гр╣Мр╣Вр╕Ъ V6 р╕Вр╕Щр╕▓р╕Ф 2.7 р╕ер╕┤р╕Хр╕г"
      }
    ],
    features: [
      "Pro Trailer Backup Assist",
      "Flexible Rack System",
      "Heavy-duty suspension",
      "Automatic stop/start system"
    ],
    priceRange: "р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ 559,000 р╕Ър╕▓р╕Ч"
  },
  everest: {
    name: "Ford Everest 2024-2025",
    seating: "7 р╕Чр╕╡р╣Ир╕Щр╕▒р╣Ир╕З",
    variants: 7,
    engines: [
      {
        type: "2.0L Single-Turbo EcoBlue Diesel",
        power: "170 HP",
        torque: "405 Nm",
        rpmRange: "1,750-2,500 RPM"
      },
      {
        type: "3.0L V6 Diesel",
        displacement: "2993 cc",
        description: "р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣Мр╕Фр╕╡р╣Ар╕Лр╕е V6"
      }
    ],
    transmission: "р╣Ар╕Бр╕╡р╕вр╕гр╣Мр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤",
    features: [
      "12-inch touchscreen infotainment",
      "Wireless Apple CarPlay & Android Auto", 
      "12.4-inch digital driver display",
      "Panoramic sunroof",
      "Wireless phone charging",
      "Dual-zone AC",
      "12-speaker Bang & Olufsen sound system",
      "Powered tailgate",
      "360-degree camera",
      "Bird's eye view"
    ],
    cargo: {
      normal: "259L",
      maximum: "1800L+ (р╣Ар╕бр╕╖р╣Ир╕нр╕Юр╕▒р╕Ър╣Ар╕Ър╕▓р╕░р╣Бр╕Цр╕зр╕Чр╕╡р╣И 2 р╣Бр╕ер╕░ 3)"
    },
    suspension: "Double wishbone independent front, Live axle with leaf spring rear"
  }
};

// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Хр╕нр╕Ър╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ъ Ford
function getResponseText(messageText) {
  const text = messageText.toLowerCase();
  
  // р╕Др╕│р╕Чр╕▒р╕Бр╕Чр╕▓р╕в
  if (text.includes('р╕кр╕зр╕▒р╕кр╕Фр╕╡') || text.includes('hello') || text.includes('hi')) {
    return `р╕кр╕зр╕▒р╕кр╕Фр╕╡р╕Др╕гр╕▒р╕Ъ! ЁЯЪЧ
р╕вр╕┤р╕Щр╕Фр╕╡р╕Хр╣Йр╕нр╕Щр╕гр╕▒р╕Ър╕кр╕╣р╣Ир╣Вр╕Кр╕зр╣Мр╕гр╕╣р╕бр╕Яр╕нр╕гр╣Мр╕Ф р╕кр╕▓р╕Вр╕▓р╕Юр╕гр╕░р╕Ыр╕гр╕░р╣Бр╕Фр╕З

р╕Ьр╕бр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Кр╣Ир╕зр╕вр╕Хр╕нр╕Ър╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ъ:
ЁЯФ╣ Ford Ranger 2024-2025
ЁЯФ╣ Ford Everest 2024-2025 
ЁЯФ╣ р╕кр╣Ар╕Ыр╕Д р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣М р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤
ЁЯФ╣ р╕гр╕▓р╕Др╕▓ р╣Бр╕ер╕░р╣Вр╕Ыр╕гр╣Вр╕бр╕Кр╕▒р╣Ир╕Щ

р╕Бр╕гр╕╕р╕Ур╕▓р╕Цр╕▓р╕бр╕Др╕│р╕Цр╕▓р╕бр╕Чр╕╡р╣Ир╕кр╕Щр╣Гр╕Ир╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╕гр╕▒р╕Ъ!`;
  }

  // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ъ Ranger
  if (text.includes('ranger')) {
    if (text.includes('р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣М') || text.includes('engine') || text.includes('р╕кр╣Ар╕Ыр╕Д')) {
      return `ЁЯЪЫ Ford Ranger 2024-2025 - р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣М

ЁЯФз р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣Мр╕Чр╕╡р╣И 1:
тАв ${fordData.ranger.engines[0].type}
тАв р╕Бр╕│р╕ер╕▒р╕З: ${fordData.ranger.engines[0].power}
тАв ${fordData.ranger.engines[0].description}

ЁЯФз р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣Мр╕Чр╕╡р╣И 2:
тАв ${fordData.ranger.engines[1].type}  
тАв р╕Бр╕│р╕ер╕▒р╕З: ${fordData.ranger.engines[1].power}
тАв ${fordData.ranger.engines[1].description}

ЁЯУЛ р╕гр╕╕р╣Ир╕Щр╕Чр╕╡р╣Ир╕бр╕╡р╕Ир╕│р╕лр╕Щр╣Ир╕▓р╕в:
${fordData.ranger.models.join(', ')}

ЁЯТ░ р╕гр╕▓р╕Др╕▓р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ: ${fordData.ranger.priceRange}

р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╣Ар╕гр╕╖р╣Ир╕нр╕Зр╣Др╕лр╕Щр╕Др╕гр╕▒р╕Ъ?`;
    }
    
    if (text.includes('р╕гр╕▓р╕Др╕▓') || text.includes('price')) {
      return `ЁЯТ░ Ford Ranger 2024-2025 - р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕гр╕▓р╕Др╕▓

р╕гр╕▓р╕Др╕▓р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ: ${fordData.ranger.priceRange}

ЁЯУЛ р╕гр╕╕р╣Ир╕Щр╕Чр╕╡р╣Ир╕бр╕╡р╕Ир╕│р╕лр╕Щр╣Ир╕▓р╕в:
${fordData.ranger.models.map((model, index) => `${index + 1}. ${model}`).join('\n')}

ЁЯУЮ р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕▓р╕Др╕▓р╣Вр╕Ыр╕гр╣Вр╕бр╕Кр╕▒р╣Ир╕Щр╕ер╣Ир╕▓р╕кр╕╕р╕Фр╣Бр╕ер╕░р╕Бр╕▓р╕гр╕Ир╕нр╕Зр╕Чр╕Фр╕ер╕нр╕Зр╕Вр╕▒р╕Ъ
р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕┤р╕Фр╕Хр╣Ир╕н: р╣Вр╕Кр╕зр╣Мр╕гр╕╣р╕бр╕Яр╕нр╕гр╣Мр╕Ф р╕Юр╕гр╕░р╕Ыр╕гр╕░р╣Бр╕Фр╕З

р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕╖р╣Ир╕Щр╣Ж р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╣Др╕лр╕бр╕Др╕гр╕▒р╕Ъ?`;
    }

    return `ЁЯЪЫ Ford Ranger 2024-2025

${fordData.ranger.name} р╕бр╕╡р╣Гр╕лр╣Йр╣Ар╕ер╕╖р╕нр╕Б ${fordData.ranger.models.length} р╕гр╕╕р╣Ир╕Щ:
${fordData.ranger.models.map((model, index) => `${index + 1}. ${model}`).join('\n')}

тЬи р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤р╣Ар╕Фр╣Ир╕Щ:
${fordData.ranger.features.map(feature => `тАв ${feature}`).join('\n')}

ЁЯТ░ р╕гр╕▓р╕Др╕▓р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ: ${fordData.ranger.priceRange}

р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Чр╕гр╕▓р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╣Ар╕гр╕╖р╣Ир╕нр╕Зр╣Др╕лр╕Щр╕Др╕гр╕▒р╕Ъ?
- р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣Мр╣Бр╕ер╕░р╕кр╣Ар╕Ыр╕Д
- р╕гр╕▓р╕Др╕▓р╣Бр╕ер╕░р╣Вр╕Ыр╕гр╣Вр╕бр╕Кр╕▒р╣Ир╕Щ`;
  }

  // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ъ Everest
  if (text.includes('everest')) {
    if (text.includes('р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣М') || text.includes('engine') || text.includes('р╕кр╣Ар╕Ыр╕Д')) {
      return `ЁЯЪЩ Ford Everest 2024-2025 - р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣М

ЁЯФз р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣Мр╕Чр╕╡р╣И 1:
тАв ${fordData.everest.engines[0].type}
тАв р╕Бр╕│р╕ер╕▒р╕З: ${fordData.everest.engines[0].power}
тАв р╣Бр╕гр╕Зр╕Ър╕┤р╕Ф: ${fordData.everest.engines[0].torque}
тАв р╕Кр╣Ир╕зр╕Зр╕гр╕нр╕Ъ: ${fordData.everest.engines[0].rpmRange}

ЁЯФз р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣Мр╕Чр╕╡р╣И 2:
тАв ${fordData.everest.engines[1].type}
тАв р╕Вр╕Щр╕▓р╕Фр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣М: ${fordData.everest.engines[1].displacement}

тЪЩя╕П р╕гр╕░р╕Ър╕Ър╕кр╣Ир╕Зр╕Бр╕│р╕ер╕▒р╕З: ${fordData.everest.transmission}
ЁЯСе р╕Чр╕╡р╣Ир╕Щр╕▒р╣Ир╕З: ${fordData.everest.seating}
ЁЯУж р╕Ир╕│р╕Щр╕зр╕Щр╕гр╕╕р╣Ир╕Щ: ${fordData.everest.variants} р╕гр╕╕р╣Ир╕Щ

р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╣Ар╕гр╕╖р╣Ир╕нр╕Зр╣Др╕лр╕Щр╕Др╕гр╕▒р╕Ъ?`;
    }

    if (text.includes('р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤') || text.includes('feature') || text.includes('р╕нр╕нр╕Ыр╕Кр╕▒р╣Ир╕Щ')) {
      return `ЁЯЪЩ Ford Everest 2024-2025 - р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤р╣Бр╕ер╕░р╕нр╕нр╕Ыр╕Кр╕▒р╣Ир╕Щ

ЁЯУ▒ р╕гр╕░р╕Ър╕Ър╕кр╕╖р╣Ир╕нр╕кр╕▓р╕гр╣Бр╕ер╕░р╕Ър╕▒р╕Щр╣Ар╕Чр╕┤р╕З:
тАв ${fordData.everest.features[0]}
тАв ${fordData.everest.features[1]}
тАв ${fordData.everest.features[2]}
тАв ${fordData.everest.features[6]}

ЁЯПа р╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕кр╕Ър╕▓р╕в:
тАв ${fordData.everest.features[3]}
тАв ${fordData.everest.features[4]}
тАв ${fordData.everest.features[5]}
тАв ${fordData.everest.features[7]}

ЁЯОе р╕гр╕░р╕Ър╕Ър╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в:
тАв ${fordData.everest.features[8]}
тАв ${fordData.everest.features[9]}

ЁЯУж р╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╣Ар╕Бр╣Зр╕Ър╕Вр╕нр╕З:
тАв р╕Ыр╕Бр╕Хр╕┤: ${fordData.everest.cargo.normal}
тАв р╕кр╕╣р╕Зр╕кр╕╕р╕Ф: ${fordData.everest.cargo.maximum}

р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕╖р╣Ир╕Щр╣Ж р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╣Др╕лр╕бр╕Др╕гр╕▒р╕Ъ?`;
    }

    return `ЁЯЪЩ Ford Everest 2024-2025

SUV ${fordData.everest.seating} р╕кр╕╕р╕Фр╕лр╕гр╕╣ р╕Юр╕гр╣Йр╕нр╕бр╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕ер╣Йр╕│р╕кр╕бр╕▒р╕в

ЁЯУК р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ:
тАв ${fordData.everest.seating}
тАв ${fordData.everest.variants} р╕гр╕╕р╣Ир╕Щр╣Гр╕лр╣Йр╣Ар╕ер╕╖р╕нр╕Б
тАв ${fordData.everest.transmission}

ЁЯОп р╣Др╕ор╣Др╕ер╕Чр╣Мр╣Ар╕Фр╣Ир╕Щ:
тАв р╕лр╕Щр╣Йр╕▓р╕Ир╕нр╕кр╕▒р╕бр╕Ьр╕▒р╕к 12 р╕Щр╕┤р╣Йр╕з
тАв р╕гр╕░р╕Ър╕Ър╣Ар╕кр╕╡р╕вр╕З Bang & Olufsen
тАв р╕Бр╕ер╣Йр╕нр╕З 360 р╕нр╕Зр╕ир╕▓
тАв р╕Лр╕▒р╕Щр╕гр╕╣р╕Яр╕Юр╕▓р╣Вр╕Щр╕гр╕▓р╕бр╕┤р╕Б

р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Чр╕гр╕▓р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╣Ар╕гр╕╖р╣Ир╕нр╕Зр╣Др╕лр╕Щр╕Др╕гр╕▒р╕Ъ?
- р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣Мр╣Бр╕ер╕░р╕кр╣Ар╕Ыр╕Д  
- р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤р╣Бр╕ер╕░р╕нр╕нр╕Ыр╕Кр╕▒р╣Ир╕Щ`;
  }

  // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╣Ир╕н
  if (text.includes('р╕Хр╕┤р╕Фр╕Хр╣Ир╕н') || text.includes('р╣Вр╕Чр╕г') || text.includes('contact')) {
    return `ЁЯУЮ р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╣Вр╕Кр╕зр╣Мр╕гр╕╣р╕бр╕Яр╕нр╕гр╣Мр╕Ф р╕Юр╕гр╕░р╕Ыр╕гр╕░р╣Бр╕Фр╕З

ЁЯПв Ford Phra Pradaeng Showroom
ЁЯУН р╕кр╕▓р╕Вр╕▓р╕Юр╕гр╕░р╕Ыр╕гр╕░р╣Бр╕Фр╕З

ЁЯХР р╣Ар╕зр╕ер╕▓р╕Чр╕│р╕Бр╕▓р╕г:
р╕Ир╕▒р╕Щр╕Чр╕гр╣М - р╕нр╕▓р╕Чр╕┤р╕Хр╕вр╣М 
08:30 - 18:00 р╕Щ.

ЁЯУЛ р╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Вр╕нр╕Зр╣Ар╕гр╕▓:
тАв р╕Фр╕╣р╕гр╕Цр╣Бр╕ер╕░р╕Чр╕Фр╕ер╕нр╕Зр╕Вр╕▒р╕Ъ
тАв р╕кр╕нр╕Ър╕Цр╕▓р╕бр╕гр╕▓р╕Др╕▓р╣Бр╕ер╕░р╣Вр╕Ыр╕гр╣Вр╕бр╕Кр╕▒р╣Ир╕Щ  
тАв р╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕лр╕ер╕▒р╕Зр╕Бр╕▓р╕гр╕Вр╕▓р╕в
тАв р╕Ир╕▒р╕Фр╕кр╕┤р╕Щр╣Ар╕Кр╕╖р╣Ир╕н

ЁЯОп р╕Юр╕┤р╣Ар╕ир╕й! р╕Щр╕▒р╕Фр╕лр╕бр╕▓р╕вр╕ер╣Ир╕зр╕Зр╕лр╕Щр╣Йр╕▓р╣Ар╕Юр╕╖р╣Ир╕нр╕гр╕▒р╕Ър╕кр╣Ир╕зр╕Щр╕ер╕Фр╕Юр╕┤р╣Ар╕ир╕й

р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Щр╕▒р╕Фр╕лр╕бр╕▓р╕вр╕лр╕гр╕╖р╕нр╕кр╕нр╕Ър╕Цр╕▓р╕бр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╣Др╕лр╕бр╕Др╕гр╕▒р╕Ъ?`;
  }

  // р╕Др╕│р╕Цр╕▓р╕бр╕Чр╕▒р╣Ир╕зр╣Др╕Ы
  if (text.includes('р╕гр╕▓р╕Др╕▓') || text.includes('price')) {
    return `ЁЯТ░ р╕гр╕▓р╕Др╕▓р╕гр╕Цр╕вр╕Щр╕Хр╣М Ford 2024-2025

ЁЯЪЫ Ford Ranger: ${fordData.ranger.priceRange}
ЁЯЪЩ Ford Everest: р╕гр╕▓р╕Др╕▓р╕Хр╕▓р╕бр╕гр╕╕р╣Ир╕Щр╣Бр╕ер╕░р╕нр╕нр╕Ыр╕Кр╕▒р╣Ир╕Щ

ЁЯУЮ р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕▓р╕Др╕▓р╣Вр╕Ыр╕гр╣Вр╕бр╕Кр╕▒р╣Ир╕Щр╕ер╣Ир╕▓р╕кр╕╕р╕Ф:
р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╣Вр╕Кр╕зр╣Мр╕гр╕╣р╕бр╣Вр╕Фр╕вр╕Хр╕гр╕З

ЁЯОБ р╣Вр╕Ыр╕гр╣Вр╕бр╕Кр╕▒р╣Ир╕Щр╕Юр╕┤р╣Ар╕ир╕й:
тАв р╣Бр╕ер╕Бр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕гр╕Цр╣Ар╕Бр╣Ир╕▓
тАв р╕Фр╕▓р╕зр╕Щр╣Мр╕Хр╣Ир╕│ р╕Ьр╣Ир╕нр╕Щр╕Щр╕▓р╕Щ
тАв р╕Ыр╕гр╕░р╕Бр╕▒р╕Щр╕ар╕▒р╕вр╕Яр╕гр╕╡
тАв р╕Вр╕нр╕Зр╣Бр╕Цр╕бр╕бр╕▓р╕Бр╕бр╕▓р╕в

р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Чр╕гр╕▓р╕Ър╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Вр╕Ыр╕гр╣Вр╕бр╕Кр╕▒р╣Ир╕Щр╣Др╕лр╕бр╕Др╕гр╕▒р╕Ъ?`;
  }

  // р╕Др╕│р╕Хр╕нр╕Ър╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ
  return `р╕Вр╕нр╕нр╕ар╕▒р╕вр╕Др╕гр╕▒р╕Ъ р╕Ьр╕бр╕нр╕▓р╕Ир╣Др╕бр╣Ир╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╕Др╕│р╕Цр╕▓р╕бр╕Вр╕нр╕Зр╕Др╕╕р╕У ЁЯШЕ

ЁЯУЛ р╕Ьр╕бр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Кр╣Ир╕зр╕вр╕Хр╕нр╕Ър╕Др╕│р╕Цр╕▓р╕бр╣Ар╕лр╕ер╣Ир╕▓р╕Щр╕╡р╣Йр╣Др╕Фр╣Й:

ЁЯЪЫ Ford Ranger 2024-2025:
- р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣Мр╣Бр╕ер╕░р╕кр╣Ар╕Ыр╕Д
- р╕гр╕╕р╣Ир╕Щр╣Бр╕ер╕░р╕гр╕▓р╕Др╕▓
- р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤р╕Юр╕┤р╣Ар╕ир╕й

ЁЯЪЩ Ford Everest 2024-2025:
- р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕вр╕Щр╕Хр╣Мр╣Бр╕ер╕░р╕кр╣Ар╕Ыр╕Д  
- р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤р╣Бр╕ер╕░р╕нр╕нр╕Ыр╕Кр╕▒р╣Ир╕Щ
- р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕▒р╣Ир╕зр╣Др╕Ы

ЁЯУЮ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╣Вр╕Кр╕зр╣Мр╕гр╕╣р╕б

р╕Бр╕гр╕╕р╕Ур╕▓р╕Цр╕▓р╕бр╕Др╕│р╕Цр╕▓р╕бр╣Гр╕лр╕бр╣И р╕лр╕гр╕╖р╕нр╕Юр╕┤р╕бр╕Юр╣М "р╕кр╕зр╕▒р╕кр╕Фр╕╡" р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╣Гр╕лр╕бр╣Ир╕Др╕гр╕▒р╕Ъ!`;
}

// Webhook endpoint р╕кр╕│р╕лр╕гр╕▒р╕Ъ LINE
app.post('/webhook', line.middleware(config), (req, res) => {
  Promise
    .all(req.body.events.map(handleEvent))
    .then((result) => res.json(result))
    .catch((err) => {
      console.error(err);
      res.status(500).end();
    });
});

// р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Ир╕▒р╕Фр╕Бр╕▓р╕г event
function handleEvent(event) {
  if (event.type !== 'message' || event.message.type !== 'text') {
    return Promise.resolve(null);
  }

  // р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Ир╕▓р╕Бр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
  const userMessage = event.message.text;
  
  // р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ
  const replyMessage = {
    type: 'text',
    text: getResponseText(userMessage)
  };

  // р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ
  return client.replyMessage(event.replyToken, replyMessage);
}

// Health check endpoint
app.get('/', (req, res) => {
  res.send('Ford LINE OA Chatbot is running! ЁЯЪЧ');
});

// р╣Ар╕гр╕┤р╣Ир╕б server
const port = process.env.PORT || 3000;
app.listen(port, '0.0.0.0', () => {
  console.log(`Ford LINE OA Chatbot is listening on port ${port}`);
});
